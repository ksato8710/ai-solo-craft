# AI Solo Builder 継続チェックリスト

このドキュメントは、AI Solo Builder の品質を維持するためのチェック項目と、それぞれをカバーする仕組みを定義する。

---

## 凡例：実行タイミング

| 記号 | 仕組み | 説明 |
|------|--------|------|
| 🔧 | pre-commit | `git commit` 時に自動実行（`.husky/pre-commit`） |
| 🚀 | pre-push | `git push` 時に自動実行（`.husky/pre-push`） |
| 🤖 | GitHub Actions | PR/push時にCI実行（`.github/workflows/ci.yml`） |
| ⏰ | cron | Clawdbot cronで定期実行（ジョブ名を明記） |
| 👀 | 手動 | 人間またはエージェントが目視確認 |

### Clawdbot cronジョブ一覧（tifa担当）

| ジョブ名 | スケジュール | 内容 |
|----------|--------------|------|
| `asb-morning-digest` | 毎日 07:30 JST | 朝刊Digest作成（**自動ソース検出・登録含む**） |
| `asb-midday-editorial` | 平日 12:30 JST | 編集枠（dev-knowledge/case-study/product、**ソース管理統合**） |
| `asb-evening-digest` | 毎日 17:30 JST | 夕刊Digest作成（**自動ソース検出・登録含む**） |
| **`AI Solo Builder ソースメンテナンス`** | **毎月1日 03:00 JST** | **月次ソース品質管理（信頼度更新・新規発見・レポート）** |

---

## 🔴 公開前チェック（毎回必須）

### 調査段階（Phase 1-2）

| チェック項目 | 🔧 | 🚀 | 🤖 | ⏰ | 👀 |
|--------------|:--:|:--:|:--:|:--:|:--:|
| 各ニュースに一次ソースURL確認済み | | | | | ✅ |
| **事例記事（case-study）は実在の人物・プロダクトに基づく** | | | | | ✅ |
| **事例記事の出典（インタビュー元、記事URL等）が本文中に明記されている** | | | | | ✅ |
| 各ニュースに発表日（publishedAt）確認済み | | | | | ✅ |
| **ソース自動検出・分類実行済み（primary/secondary/tertiary）** | | | | **各記事cron** | ✅ |
| **記事にソース信頼度スコア（1-10）自動付与** | | | | **各記事cron** | ✅ |
| **新規ソースの自動登録・DB更新完了** | | | | **各記事cron** | ✅ |
| 期間適切性フィルタ通過（朝刊: 前夕刊〜今朝刊、夕刊: 前朝刊〜今夕刊）| | | | | ✅ |
| **ソース信頼度を考慮したNVA評価実行** | | | | | ✅ |
| ニュース内容が一次ソースと一致（誇張・歪曲なし）| | | | | ✅ |
| `news_candidates` テーブルに保存済み | | | | | ✅ |

### Frontmatter整合性

| チェック項目 | 🔧 | 🚀 | 🤖 | ⏰ | 👀 |
|--------------|:--:|:--:|:--:|:--:|:--:|
| `contentType` が `news \| product \| digest` のいずれか | ✅ | ✅ | ✅ | | |
| Digestには `digestEdition: morning \| evening` あり | ✅ | ✅ | ✅ | | |
| `relatedProducts` は配列形式 `["slug"]` | ✅ | ✅ | ✅ | | |
| `tags` は配列形式 | ✅ | ✅ | ✅ | | |
| **ニュース記事の `tags` 先頭に分類タグあり** | | | | | ✅ |
| `readTime` が数値で設定済み（productsは移行中許容） | ✅ | ✅ | ✅ | | |
| `slug` が他ファイルと重複していない | ✅ | ✅ | ✅ | | |
| YAML構文が正しい（パースエラーなし） | ✅ | ✅ | ✅ | | |

### Digest必須構造

| チェック項目 | 🔧 | 🚀 | 🤖 | ⏰ | 👀 |
|--------------|:--:|:--:|:--:|:--:|:--:|
| `## 🏁 重要ニュースランキング（NVA）` セクションあり | ✅ | ✅ | ✅ | | |
| Top10ランキング表あり | ✅ | ✅ | ✅ | | |
| `## 🔥 Top 3 ピックアップ` セクションあり | ✅ | ✅ | ✅ | | |
| Top3の個別記事が存在する | | | | | ✅ |
| **Top10記事が適切な期間内**（朝刊: 前夕刊〜今朝刊、夕刊: 前朝刊〜今夕刊） | | | | | ✅ |

### サムネイル・画像チェック

| チェック項目 | 🔧 | 🚀 | 🤖 | ⏰ | 👀 |
|--------------|:--:|:--:|:--:|:--:|:--:|
| 全記事に `image` フィールドが設定されている | ✅ | ✅ | ✅ | | |
| `image` URLが有効（HTTP 200） | | ✅ | ✅ | | |
| 記事間で同一画像URLの重複がない | ✅ | ✅ | ✅ | | |

### テーブルレイアウト

| チェック項目 | 🔧 | 🚀 | 🤖 | ⏰ | 👀 |
|--------------|:--:|:--:|:--:|:--:|:--:|
| 各テーブルが異なる列構造でも正常表示（汎用CSS使用） | | | | | ✅ |
| 短いセル（数値/スコア）が過度に広がらない | | | | | ✅ |
| 長いセル（説明文/タイトル）が狭すぎて改行過多にならない | | | | | ✅ |
| **モバイルでテーブルが画面幅に収まる（横はみ出しなし）** | | | | | ✅ |
| **モバイルでリンクテキストが折り返されている** | | | | | ✅ |
| **モバイルカードで各セルにラベルが表示されている** | | | | | ✅ |
| **PCで記事コンテンツが680px以内に収まっている** | | | | | ✅ |

### コードブロック表示

| チェック項目 | 🔧 | 🚀 | 🤖 | ⏰ | 👀 |
|--------------|:--:|:--:|:--:|:--:|:--:|
| **コードブロックが背景色付きで表示（`pre > code`）** | | | | | ✅ |
| **インラインコードがバッジ風に表示（`code`）** | | | | | ✅ |
| **コードがモノスペースフォントで表示** | | | | | ✅ |
| **横長コードでも横スクロール可能（はみ出しなし）** | | | | | ✅ |

### リンク表示（note/Zennライク）

| チェック項目 | 🔧 | 🚀 | 🤖 | ⏰ | 👀 |
|--------------|:--:|:--:|:--:|:--:|:--:|
| **リンクが本文に馴染む色（派手な青ではない）** | | | | | ✅ |
| **リンクに薄いアンダーライン** | | | | | ✅ |
| **ホバー時に色・アンダーラインが変化** | | | | | ✅ |
| **外部リンクに小さな↗アイコン** | | | | | ✅ |

### リンク整合性・ソース整合性

| チェック項目 | 🔧 | 🚀 | 🤖 | ⏰ | 👀 |
|--------------|:--:|:--:|:--:|:--:|:--:|
| `relatedProducts` のslugが `/products/[slug]` に存在 | ✅ | ✅ | ✅ | | |
| 本文中の `/products/[slug]` リンクが404にならない | | ✅ | ✅ | | |
| **記事の `primary_source_id` が `sources` テーブルに存在** | | ✅ | ✅ | | |
| **ソース信頼度スコアが適切な範囲内（1.0-10.0）** | | ✅ | ✅ | | |
| **記事内ソースURLとDB登録ソースの一致確認** | | ✅ | ✅ | | |
| 外部URLが有効（一次ソース確認） | | | | `週次監査cron` | ✅ |

### ゲート通過

| チェック項目 | 🔧 | 🚀 | 🤖 | ⏰ | 👀 |
|--------------|:--:|:--:|:--:|:--:|:--:|
| `npm run validate:content` 成功 | ✅ | ✅ | ✅ | | |
| `npm run sync:content:db` 成功 | | ✅ | ✅ | | |
| `npm run build` 成功 | | ✅ | ✅ | | |

---

## 🟠 ビジュアル・UI チェック（デプロイ後）

| チェック項目 | 🔧 | 🚀 | 🤖 | ⏰ | 👀 |
|--------------|:--:|:--:|:--:|:--:|:--:|
| ホーム画面で全記事のサムネイル画像が表示されている | | | | 各記事cron完了時 | ✅ |
| ホーム画面で同一画像の重複がない | | | | 各記事cron完了時 | ✅ |
| OGP画像（1200×630）が正しく生成されている | | | | | ✅ |
| 記事ページのレイアウト崩れなし | | | | | ✅ |

---

## 🟡 日次チェック

### 朝刊（08:00公開目標）— cron: `asb-morning-digest`

| チェック項目 | 🔧 | 🚀 | 🤖 | ⏰ | 👀 |
|--------------|:--:|:--:|:--:|:--:|:--:|
| 07:30までに作成開始 | | | | `asb-morning-digest` | |
| NVA評価でTop10選定済み | | | | | ✅ |
| Top10が適切な期間内（前夕刊〜今朝刊）| | | | | ✅ |
| Top3の個別記事作成済み | | | | | ✅ |
| サムネイル設定・重複なしを確認 | | | | `asb-morning-digest` | ✅ |
| Slack #tifa にスレッド形式で報告 | | | | `asb-morning-digest` | |

### 夕刊（18:00公開目標）— cron: `asb-evening-digest`

| チェック項目 | 🔧 | 🚀 | 🤖 | ⏰ | 👀 |
|--------------|:--:|:--:|:--:|:--:|:--:|
| 17:30までに作成開始 | | | | `asb-evening-digest` | |
| 朝刊との重複を避けたTop10選定 | | | | | ✅ |
| Top10が適切な期間内（前朝刊〜今夕刊）| | | | | ✅ |
| Top3の個別記事作成済み | | | | | ✅ |
| サムネイル設定・重複なしを確認 | | | | `asb-evening-digest` | ✅ |
| Slack #tifa にスレッド形式で報告 | | | | `asb-evening-digest` | |

### 平日編集枠（12:30）— cron: `asb-midday-editorial`

| チェック項目 | 🔧 | 🚀 | 🤖 | ⏰ | 👀 |
|--------------|:--:|:--:|:--:|:--:|:--:|
| 曜日別カテゴリ補完（月木: dev-knowledge、火金: case-study、水: product） | | | | `asb-midday-editorial` | |
| サムネイル設定・重複なしを確認 | | | | `asb-midday-editorial` | ✅ |

### デプロイ後確認（各記事cron完了時に実施）

| チェック項目 | 🔧 | 🚀 | 🤖 | ⏰ | 👀 |
|--------------|:--:|:--:|:--:|:--:|:--:|
| 本番サイトでページが正常表示 | | | | 各記事cron完了時 | ✅ |
| API `/api/v1/feed` が最新記事を返す | | | | 各記事cron完了時 | |

---

## 🟢 週次チェック

> **重要:** 各記事作成cronの完了報告時に、以下の週次チェック観点も含めて確認・報告すること。

### コンテンツバランス

| チェック項目 | 🔧 | 🚀 | 🤖 | ⏰ | 👀 |
|--------------|:--:|:--:|:--:|:--:|:--:|
| news / digest / product の配分が適切 | | | | 各記事cron完了時 | ✅ |
| tags分布の偏りなし | | | | 各記事cron完了時 | |
| プロダクト辞書の更新漏れなし | | | | 各記事cron完了時 | ✅ |

### DB整合性

| チェック項目 | 🔧 | 🚀 | 🤖 | ⏰ | 👀 |
|--------------|:--:|:--:|:--:|:--:|:--:|
| Markdown ↔ DB のレコード数一致 | | | | `週次監査cron`（要追加） | |
| orphan（孤立）レコードなし | | | | `週次監査cron`（要追加） | |
| digest_details の edition/date 重複なし | | | | `週次監査cron`（要追加） | |

### パフォーマンス

| チェック項目 | 🔧 | 🚀 | 🤖 | ⏰ | 👀 |
|--------------|:--:|:--:|:--:|:--:|:--:|
| ビルド時間が2分以内 | | | ✅ | | |
| Vercelデプロイエラーなし | | | ✅ | | |

### 外部リンク

| チェック項目 | 🔧 | 🚀 | 🤖 | ⏰ | 👀 |
|--------------|:--:|:--:|:--:|:--:|:--:|
| 壊れた外部リンクの検出・修正 | | | | `週次監査cron`（要追加） | |

---

## 🔵 月次チェック

### **ソース品質管理（Phase 4: 運用最適化）— cron: `AI Solo Builder ソースメンテナンス`**

| チェック項目 | 🔧 | 🚀 | 🤖 | ⏰ | 👀 |
|--------------|:--:|:--:|:--:|:--:|:--:|
| **過去30日のソース利用状況分析・信頼度更新** | | | | **`AI Solo Builder ソースメンテナンス`** | |
| **新規ソース自動発見・分類・追加** | | | | **`AI Solo Builder ソースメンテナンス`** | |
| **非アクティブソース検出（90日未利用）** | | | | **`AI Solo Builder ソースメンテナンス`** | |
| **詳細レポート生成・保存・Slack報告** | | | | **`AI Solo Builder ソースメンテナンス`** | |
| **ソース信頼度の適正性確認（1.0-10.0範囲内）** | | | | **`AI Solo Builder ソースメンテナンス`** | ✅ |

### ポリシー準拠

| チェック項目 | 🔧 | 🚀 | 🤖 | ⏰ | 👀 |
|--------------|:--:|:--:|:--:|:--:|:--:|
| `specs/content-policy/spec.md` との乖離なし | | | | `月次監査cron`（要追加） | ✅ |
| legacy形式（`category`, `relatedProduct`）の残存なし | | | | `月次監査cron`（要追加） | |

### コンテンツ棚卸し

| チェック項目 | 🔧 | 🚀 | 🤖 | ⏰ | 👀 |
|--------------|:--:|:--:|:--:|:--:|:--:|
| 古い記事の更新要否判断 | | | | | ✅ |
| 参照されていないプロダクトページの整理 | | | | `月次監査cron`（要追加） | |

### 運用改善

| チェック項目 | 🔧 | 🚀 | 🤖 | ⏰ | 👀 |
|--------------|:--:|:--:|:--:|:--:|:--:|
| よくあるエラーパターンの自動化検討 | | | | | ✅ |
| このチェックリスト自体の更新 | | | | | ✅ |

---

## 実装状況

### 🔧 pre-commit（`.husky/pre-commit`）

**状態:** ✅ 実装済み

```bash
#!/bin/sh
npm run validate:content
npm run check:images
```

### 🚀 pre-push（`.husky/pre-push`）

**状態:** ✅ 実装済み

```bash
#!/bin/sh
npm run publish:gate
```

### 🤖 GitHub Actions（`.github/workflows/ci.yml`）

**状態:** ✅ 実装済み

```yaml
name: CI
on: [push, pull_request]
jobs:
  validate:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-node@v4
      - run: npm ci
      - run: npm run validate:content
      - run: npm run check:images
      - run: npm run build
```

### ⏰ Clawdbot cron

**既存ジョブ:**
| ジョブ名 | スケジュール | 担当 |
|----------|--------------|------|
| `asb-morning-digest` | 07:30 | tifa |
| `asb-midday-editorial` | 12:30（平日） | tifa |
| `asb-evening-digest` | 17:30 | tifa |

**追加予定:**
| ジョブ名 | スケジュール | 内容 |
|----------|--------------|------|
| `asb-weekly-audit` | 毎週月曜 09:00 | DB整合性・外部リンク・コンテンツバランス |
| `asb-monthly-audit` | 毎月1日 09:00 | ポリシー準拠・legacy残存・棚卸し |

---

## Slack完了報告テンプレート

各記事作成cronの完了時、以下の観点を含めて報告する:

```
✅ [朝刊/夕刊/編集枠] 公開完了

📊 作成内容:
- Digest: X本
- News: X本
- Product: X件作成/更新

🔍 品質チェック:
- サムネイル: 全記事設定済み ✅ / ⚠️ 未設定あり
- 画像重複: なし ✅ / ⚠️ 重複あり
- Top10期間: 適切 ✅ / ⚠️ 期間外あり
- 週次バランス: news X / digest X / product X

🔗 公開URL:
- https://ai.essential-navigator.com/news/[slug]
```

---

## 分類タグルール（2026-02-16 追加）

### ニュース記事の分類タグ

ニュース記事（`contentType: news`）は、`tags` 配列の**先頭**に以下のいずれかの分類タグを置く必要がある。これにより、ホーム画面とカード表示で正しいバッジが表示される。

| 分類タグ | 表示ラベル | 用途 |
|----------|------------|------|
| `dev-knowledge` | ナレッジ | 技術解説、ガイド、チュートリアル、arXiv論文解説 |
| `case-study` | 事例 | ソロビルダー事例、成功談、収益報告 |
| `product-update` | ツール紹介 | 新機能リリース、GA発表、ツール比較 |
| `other` | その他 | 上記に該当しない業界ニュース、著作権問題など |

**⚠️ 重要:**
- 分類タグがない、または認識されないタグのみの場合、「その他」として表示される
- `product-update` タグを使う場合は、`relatedProducts` に関連プロダクトのslugを指定する必要がある
- 日本語タグ（「開発ナレッジ」「ツール紹介」など）は認識されないため使用禁止

**例（正しい）:**
```yaml
tags: ["dev-knowledge", "Claude", "Anthropic"]  # ← 先頭に分類タグ
```

**例（誤り）:**
```yaml
tags: ["Claude", "Anthropic", "無料プラン"]  # ← 分類タグがないため「その他」表示
```

### 修正スクリプト

既存記事のタグを一括修正するスクリプト:
```bash
node scripts/fix-news-tags.mjs --dry-run  # 確認
node scripts/fix-news-tags.mjs            # 実行
```

---

## 更新履歴

| 日付 | 内容 |
|------|------|
| **2026-02-16** | **分類タグルール追加（dev-knowledge/case-study/product-update/other）** |
| **2026-02-16** | **コードブロック表示スタイル追加、リンク表示をnote/Zennライクに改善** |
| **2026-02-16** | **モバイルテーブル表示チェック項目追加（はみ出し防止）** |
| **2026-02-13** | **Phase 4運用最適化：ソース管理システム統合** |
| | ✅ cronジョブ一覧にソースメンテナンス追加 |
| | ✅ 調査段階にソース自動検出・分類・信頼度チェック追加 |
| | ✅ ソース整合性チェック項目追加 |
| | ✅ 月次ソース品質管理チェックセクション追加 |
| 2026-02-12 | 初版作成（canonical移行後） |
| 2026-02-12 | cron名明記、サムネイルチェック追加、完了報告テンプレート追加 |
